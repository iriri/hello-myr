use std
use "lwt"

var t, t1

const main = {
	var m = lwt.init()
	var w = "world\n"
	var world = {
		for ; ;
			std.put(w)
			lwt.swap(t1, m)
		;;
	}
	t = lwt.mk(hello, 0x1000)
	t1 = lwt.mk(world, 0x1000)
	for ; ;
		std.put("\n")
		lwt.swap(m, t)
	;;
}

const hello = {
	for ; ;
		std.put("hello\n")
		lwt.swap(t, t1)
	;;
}
